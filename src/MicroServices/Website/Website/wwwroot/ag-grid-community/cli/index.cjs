#!/usr/bin/env node
"use strict";var yr=Object.defineProperty;var wr=(e,t,r)=>t in e?yr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ye=(e,t,r)=>(wr(e,typeof t!="symbol"?t+"":t,r),r);const Sr=require("@ag-grid-community/codemods"),Rr=require("fs"),Ir=require("constants"),Or=require("stream"),Tr=require("util"),Nr=require("assert"),ge=require("node:util"),Lr=require("node:worker_threads"),P=require("node:path"),Ar=require("node:os"),br=require("node:child_process"),Jt=require("node:module");var Ne=typeof document<"u"?document.currentScript:null;const ot=Symbol(),Cr={create:Dr,match:Kt};function Ke(e,t){return{[ot]:e,...t}}function Ze(e,t){return e[ot]===t}function Dr(e){const r=Object.keys(e).map(n=>[n,_r(n)]);return Object.fromEntries(r)}function _r(e){return t.is=r,t;function t(n){return Ke(e,n)}function r(n){return Ze(n,e)}}function Kt(e,t){return t[e[ot]](e)}function de(e){return e!=null}function Fr(e){return{run(t,r){const{fs:n}=r,{readFile:i,writeFile:s}=n,{inputFilePath:c,dryRun:h,applyDangerousEdits:a}=t;return i(c,"utf-8").catch(u=>Promise.reject(xr("ENOENT",u)?new Error(`File not found: ${c}`):u)).then(u=>{const{source:o,errors:l,warnings:v}=e({path:c,source:u},{applyDangerousEdits:a,fs:n}),p=o===u,m={source:u,updated:p?null:o};return h||!o||p?{result:m,errors:l,warnings:v}:s(c,o).then(()=>({result:m,errors:l,warnings:v}))})}}}function xr(e,t){return e instanceof Error&&e.code===t}var et=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Zt(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var re=Ir,Pr=process.cwd,Fe=null,jr=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){return Fe||(Fe=Pr.call(process)),Fe};try{process.cwd()}catch{}if(typeof process.chdir=="function"){var Et=process.chdir;process.chdir=function(e){Fe=null,Et.call(process,e)},Object.setPrototypeOf&&Object.setPrototypeOf(process.chdir,Et)}var Gr=Ur;function Ur(e){re.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./)&&t(e),e.lutimes||r(e),e.chown=s(e.chown),e.fchown=s(e.fchown),e.lchown=s(e.lchown),e.chmod=n(e.chmod),e.fchmod=n(e.fchmod),e.lchmod=n(e.lchmod),e.chownSync=c(e.chownSync),e.fchownSync=c(e.fchownSync),e.lchownSync=c(e.lchownSync),e.chmodSync=i(e.chmodSync),e.fchmodSync=i(e.fchmodSync),e.lchmodSync=i(e.lchmodSync),e.stat=h(e.stat),e.fstat=h(e.fstat),e.lstat=h(e.lstat),e.statSync=a(e.statSync),e.fstatSync=a(e.fstatSync),e.lstatSync=a(e.lstatSync),e.chmod&&!e.lchmod&&(e.lchmod=function(o,l,v){v&&process.nextTick(v)},e.lchmodSync=function(){}),e.chown&&!e.lchown&&(e.lchown=function(o,l,v,p){p&&process.nextTick(p)},e.lchownSync=function(){}),jr==="win32"&&(e.rename=typeof e.rename!="function"?e.rename:function(o){function l(v,p,m){var S=Date.now(),R=0;o(v,p,function T(O){if(O&&(O.code==="EACCES"||O.code==="EPERM"||O.code==="EBUSY")&&Date.now()-S<6e4){setTimeout(function(){e.stat(p,function(N,_){N&&N.code==="ENOENT"?o(v,p,T):m(O)})},R),R<100&&(R+=10);return}m&&m(O)})}return Object.setPrototypeOf&&Object.setPrototypeOf(l,o),l}(e.rename)),e.read=typeof e.read!="function"?e.read:function(o){function l(v,p,m,S,R,T){var O;if(T&&typeof T=="function"){var N=0;O=function(_,W,H){if(_&&_.code==="EAGAIN"&&N<10)return N++,o.call(e,v,p,m,S,R,O);T.apply(this,arguments)}}return o.call(e,v,p,m,S,R,O)}return Object.setPrototypeOf&&Object.setPrototypeOf(l,o),l}(e.read),e.readSync=typeof e.readSync!="function"?e.readSync:function(o){return function(l,v,p,m,S){for(var R=0;;)try{return o.call(e,l,v,p,m,S)}catch(T){if(T.code==="EAGAIN"&&R<10){R++;continue}throw T}}}(e.readSync);function t(o){o.lchmod=function(l,v,p){o.open(l,re.O_WRONLY|re.O_SYMLINK,v,function(m,S){if(m){p&&p(m);return}o.fchmod(S,v,function(R){o.close(S,function(T){p&&p(R||T)})})})},o.lchmodSync=function(l,v){var p=o.openSync(l,re.O_WRONLY|re.O_SYMLINK,v),m=!0,S;try{S=o.fchmodSync(p,v),m=!1}finally{if(m)try{o.closeSync(p)}catch{}else o.closeSync(p)}return S}}function r(o){re.hasOwnProperty("O_SYMLINK")&&o.futimes?(o.lutimes=function(l,v,p,m){o.open(l,re.O_SYMLINK,function(S,R){if(S){m&&m(S);return}o.futimes(R,v,p,function(T){o.close(R,function(O){m&&m(T||O)})})})},o.lutimesSync=function(l,v,p){var m=o.openSync(l,re.O_SYMLINK),S,R=!0;try{S=o.futimesSync(m,v,p),R=!1}finally{if(R)try{o.closeSync(m)}catch{}else o.closeSync(m)}return S}):o.futimes&&(o.lutimes=function(l,v,p,m){m&&process.nextTick(m)},o.lutimesSync=function(){})}function n(o){return o&&function(l,v,p){return o.call(e,l,v,function(m){u(m)&&(m=null),p&&p.apply(this,arguments)})}}function i(o){return o&&function(l,v){try{return o.call(e,l,v)}catch(p){if(!u(p))throw p}}}function s(o){return o&&function(l,v,p,m){return o.call(e,l,v,p,function(S){u(S)&&(S=null),m&&m.apply(this,arguments)})}}function c(o){return o&&function(l,v,p){try{return o.call(e,l,v,p)}catch(m){if(!u(m))throw m}}}function h(o){return o&&function(l,v,p){typeof v=="function"&&(p=v,v=null);function m(S,R){R&&(R.uid<0&&(R.uid+=4294967296),R.gid<0&&(R.gid+=4294967296)),p&&p.apply(this,arguments)}return v?o.call(e,l,v,m):o.call(e,l,m)}}function a(o){return o&&function(l,v){var p=v?o.call(e,l,v):o.call(e,l);return p&&(p.uid<0&&(p.uid+=4294967296),p.gid<0&&(p.gid+=4294967296)),p}}function u(o){if(!o||o.code==="ENOSYS")return!0;var l=!process.getuid||process.getuid()!==0;return!!(l&&(o.code==="EINVAL"||o.code==="EPERM"))}}var $t=Or.Stream,qr=Mr;function Mr(e){return{ReadStream:t,WriteStream:r};function t(n,i){if(!(this instanceof t))return new t(n,i);$t.call(this);var s=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=64*1024,i=i||{};for(var c=Object.keys(i),h=0,a=c.length;h<a;h++){var u=c[h];this[u]=i[u]}if(this.encoding&&this.setEncoding(this.encoding),this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){s._read()});return}e.open(this.path,this.flags,this.mode,function(o,l){if(o){s.emit("error",o),s.readable=!1;return}s.fd=l,s.emit("open",l),s._read()})}function r(n,i){if(!(this instanceof r))return new r(n,i);$t.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,i=i||{};for(var s=Object.keys(i),c=0,h=s.length;c<h;c++){var a=s[c];this[a]=i[a]}if(this.start!==void 0){if(typeof this.start!="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.busy=!1,this._queue=[],this.fd===null&&(this._open=e.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush())}}var Vr=Xr,Wr=Object.getPrototypeOf||function(e){return e.__proto__};function Xr(e){if(e===null||typeof e!="object")return e;if(e instanceof Object)var t={__proto__:Wr(e)};else var t=Object.create(null);return Object.getOwnPropertyNames(e).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}var j=Rr,kr=Gr,Hr=qr,Yr=Vr,Le=Tr,q,Pe;typeof Symbol=="function"&&typeof Symbol.for=="function"?(q=Symbol.for("graceful-fs.queue"),Pe=Symbol.for("graceful-fs.previous")):(q="___graceful-fs.queue",Pe="___graceful-fs.previous");function zr(){}function er(e,t){Object.defineProperty(e,q,{get:function(){return t}})}var oe=zr;Le.debuglog?oe=Le.debuglog("gfs4"):/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&(oe=function(){var e=Le.format.apply(Le,arguments);e="GFS4: "+e.split(/\n/).join(`
GFS4: `),console.error(e)});if(!j[q]){var Br=et[q]||[];er(j,Br),j.close=function(e){function t(r,n){return e.call(j,r,function(i){i||yt(),typeof n=="function"&&n.apply(this,arguments)})}return Object.defineProperty(t,Pe,{value:e}),t}(j.close),j.closeSync=function(e){function t(r){e.apply(j,arguments),yt()}return Object.defineProperty(t,Pe,{value:e}),t}(j.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||"")&&process.on("exit",function(){oe(j[q]),Nr.equal(j[q].length,0)})}et[q]||er(et,j[q]);var tr=at(Yr(j));process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!j.__patched&&(tr=at(j),j.__patched=!0);function at(e){kr(e),e.gracefulify=at,e.createReadStream=W,e.createWriteStream=H;var t=e.readFile;e.readFile=r;function r(I,L,A){return typeof L=="function"&&(A=L,L=null),F(I,L,A);function F(f,d,$,y){return t(f,d,function(E){E&&(E.code==="EMFILE"||E.code==="ENFILE")?le([F,[f,d,$],E,y||Date.now(),Date.now()]):typeof $=="function"&&$.apply(this,arguments)})}}var n=e.writeFile;e.writeFile=i;function i(I,L,A,F){return typeof A=="function"&&(F=A,A=null),f(I,L,A,F);function f(d,$,y,E,g){return n(d,$,y,function(w){w&&(w.code==="EMFILE"||w.code==="ENFILE")?le([f,[d,$,y,E],w,g||Date.now(),Date.now()]):typeof E=="function"&&E.apply(this,arguments)})}}var s=e.appendFile;s&&(e.appendFile=c);function c(I,L,A,F){return typeof A=="function"&&(F=A,A=null),f(I,L,A,F);function f(d,$,y,E,g){return s(d,$,y,function(w){w&&(w.code==="EMFILE"||w.code==="ENFILE")?le([f,[d,$,y,E],w,g||Date.now(),Date.now()]):typeof E=="function"&&E.apply(this,arguments)})}}var h=e.copyFile;h&&(e.copyFile=a);function a(I,L,A,F){return typeof A=="function"&&(F=A,A=0),f(I,L,A,F);function f(d,$,y,E,g){return h(d,$,y,function(w){w&&(w.code==="EMFILE"||w.code==="ENFILE")?le([f,[d,$,y,E],w,g||Date.now(),Date.now()]):typeof E=="function"&&E.apply(this,arguments)})}}var u=e.readdir;e.readdir=l;var o=/^v[0-5]\./;function l(I,L,A){typeof L=="function"&&(A=L,L=null);var F=o.test(process.version)?function($,y,E,g){return u($,f($,y,E,g))}:function($,y,E,g){return u($,y,f($,y,E,g))};return F(I,L,A);function f(d,$,y,E){return function(g,w){g&&(g.code==="EMFILE"||g.code==="ENFILE")?le([F,[d,$,y],g,E||Date.now(),Date.now()]):(w&&w.sort&&w.sort(),typeof y=="function"&&y.call(this,g,w))}}}if(process.version.substr(0,4)==="v0.8"){var v=Hr(e);T=v.ReadStream,N=v.WriteStream}var p=e.ReadStream;p&&(T.prototype=Object.create(p.prototype),T.prototype.open=O);var m=e.WriteStream;m&&(N.prototype=Object.create(m.prototype),N.prototype.open=_),Object.defineProperty(e,"ReadStream",{get:function(){return T},set:function(I){T=I},enumerable:!0,configurable:!0}),Object.defineProperty(e,"WriteStream",{get:function(){return N},set:function(I){N=I},enumerable:!0,configurable:!0});var S=T;Object.defineProperty(e,"FileReadStream",{get:function(){return S},set:function(I){S=I},enumerable:!0,configurable:!0});var R=N;Object.defineProperty(e,"FileWriteStream",{get:function(){return R},set:function(I){R=I},enumerable:!0,configurable:!0});function T(I,L){return this instanceof T?(p.apply(this,arguments),this):T.apply(Object.create(T.prototype),arguments)}function O(){var I=this;X(I.path,I.flags,I.mode,function(L,A){L?(I.autoClose&&I.destroy(),I.emit("error",L)):(I.fd=A,I.emit("open",A),I.read())})}function N(I,L){return this instanceof N?(m.apply(this,arguments),this):N.apply(Object.create(N.prototype),arguments)}function _(){var I=this;X(I.path,I.flags,I.mode,function(L,A){L?(I.destroy(),I.emit("error",L)):(I.fd=A,I.emit("open",A))})}function W(I,L){return new e.ReadStream(I,L)}function H(I,L){return new e.WriteStream(I,L)}var te=e.open;e.open=X;function X(I,L,A,F){return typeof A=="function"&&(F=A,A=null),f(I,L,A,F);function f(d,$,y,E,g){return te(d,$,y,function(w,C){w&&(w.code==="EMFILE"||w.code==="ENFILE")?le([f,[d,$,y,E],w,g||Date.now(),Date.now()]):typeof E=="function"&&E.apply(this,arguments)})}}return e}function le(e){oe("ENQUEUE",e[0].name,e[1]),j[q].push(e),ut()}var Ae;function yt(){for(var e=Date.now(),t=0;t<j[q].length;++t)j[q][t].length>2&&(j[q][t][3]=e,j[q][t][4]=e);ut()}function ut(){if(clearTimeout(Ae),Ae=void 0,j[q].length!==0){var e=j[q].shift(),t=e[0],r=e[1],n=e[2],i=e[3],s=e[4];if(i===void 0)oe("RETRY",t.name,r),t.apply(null,r);else if(Date.now()-i>=6e4){oe("TIMEOUT",t.name,r);var c=r.pop();typeof c=="function"&&c.call(null,n)}else{var h=Date.now()-s,a=Math.max(s-i,1),u=Math.min(a*1.2,100);h>=u?(oe("RETRY",t.name,r),t.apply(null,r.concat([i]))):j[q].push(e)}Ae===void 0&&(Ae=setTimeout(ut,0))}}const ue=Zt(tr),wt={readFile:ge.promisify(ue.readFile),writeFile:ge.promisify(ue.writeFile)};function Qr(e=ue){return{readFile:t,readFileSync:r,writeFile:n,writeFileSync:i};function t(s,c){return wt.readFile(s,c)}function r(s,c){return e.readFileSync(s,c)}function n(s,c){return wt.writeFile(s,c)}function i(s,c){return e.writeFileSync(s,c)}}function ne(){}ne.prototype={diff:function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=n.callback;typeof n=="function"&&(i=n,n={}),this.options=n;var s=this;function c(S){return i?(setTimeout(function(){i(void 0,S)},0),!0):S}t=this.castInput(t),r=this.castInput(r),t=this.removeEmpty(this.tokenize(t)),r=this.removeEmpty(this.tokenize(r));var h=r.length,a=t.length,u=1,o=h+a;n.maxEditLength&&(o=Math.min(o,n.maxEditLength));var l=[{newPos:-1,components:[]}],v=this.extractCommon(l[0],r,t,0);if(l[0].newPos+1>=h&&v+1>=a)return c([{value:this.join(r),count:r.length}]);function p(){for(var S=-1*u;S<=u;S+=2){var R=void 0,T=l[S-1],O=l[S+1],N=(O?O.newPos:0)-S;T&&(l[S-1]=void 0);var _=T&&T.newPos+1<h,W=O&&0<=N&&N<a;if(!_&&!W){l[S]=void 0;continue}if(!_||W&&T.newPos<O.newPos?(R=Kr(O),s.pushComponent(R.components,void 0,!0)):(R=T,R.newPos++,s.pushComponent(R.components,!0,void 0)),N=s.extractCommon(R,r,t,S),R.newPos+1>=h&&N+1>=a)return c(Jr(s,R.components,r,t,s.useLongestToken));l[S]=R}u++}if(i)(function S(){setTimeout(function(){if(u>o)return i();p()||S()},0)})();else for(;u<=o;){var m=p();if(m)return m}},pushComponent:function(t,r,n){var i=t[t.length-1];i&&i.added===r&&i.removed===n?t[t.length-1]={count:i.count+1,added:r,removed:n}:t.push({count:1,added:r,removed:n})},extractCommon:function(t,r,n,i){for(var s=r.length,c=n.length,h=t.newPos,a=h-i,u=0;h+1<s&&a+1<c&&this.equals(r[h+1],n[a+1]);)h++,a++,u++;return u&&t.components.push({count:u}),t.newPos=h,a},equals:function(t,r){return this.options.comparator?this.options.comparator(t,r):t===r||this.options.ignoreCase&&t.toLowerCase()===r.toLowerCase()},removeEmpty:function(t){for(var r=[],n=0;n<t.length;n++)t[n]&&r.push(t[n]);return r},castInput:function(t){return t},tokenize:function(t){return t.split("")},join:function(t){return t.join("")}};function Jr(e,t,r,n,i){for(var s=0,c=t.length,h=0,a=0;s<c;s++){var u=t[s];if(u.removed){if(u.value=e.join(n.slice(a,a+u.count)),a+=u.count,s&&t[s-1].added){var l=t[s-1];t[s-1]=t[s],t[s]=l}}else{if(!u.added&&i){var o=r.slice(h,h+u.count);o=o.map(function(p,m){var S=n[a+m];return S.length>p.length?S:p}),u.value=e.join(o)}else u.value=e.join(r.slice(h,h+u.count));h+=u.count,u.added||(a+=u.count)}}var v=t[c-1];return c>1&&typeof v.value=="string"&&(v.added||v.removed)&&e.equals("",v.value)&&(t[c-2].value+=v.value,t.pop()),t}function Kr(e){return{newPos:e.newPos,components:e.components.slice(0)}}var St=/^[A-Za-z\xC0-\u02C6\u02C8-\u02D7\u02DE-\u02FF\u1E00-\u1EFF]+$/,Rt=/\S/,rr=new ne;rr.equals=function(e,t){return this.options.ignoreCase&&(e=e.toLowerCase(),t=t.toLowerCase()),e===t||this.options.ignoreWhitespace&&!Rt.test(e)&&!Rt.test(t)};rr.tokenize=function(e){for(var t=e.split(/([^\S\r\n]+|[()[\]{}'"\r\n]|\b)/),r=0;r<t.length-1;r++)!t[r+1]&&t[r+2]&&St.test(t[r])&&St.test(t[r+2])&&(t[r]+=t[r+2],t.splice(r+1,2),r--);return t};var ct=new ne;ct.tokenize=function(e){var t=[],r=e.split(/(\n|\r\n)/);r[r.length-1]||r.pop();for(var n=0;n<r.length;n++){var i=r[n];n%2&&!this.options.newlineIsToken?t[t.length-1]+=i:(this.options.ignoreWhitespace&&(i=i.trim()),t.push(i))}return t};function Zr(e,t,r){return ct.diff(e,t,r)}var en=new ne;en.tokenize=function(e){return e.split(/(\S.+?[.!?])(?=\s+|$)/)};var tn=new ne;tn.tokenize=function(e){return e.split(/([{}:;,]|\s+)/)};function xe(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?xe=function(t){return typeof t}:xe=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xe(e)}function We(e){return rn(e)||nn(e)||sn(e)||on()}function rn(e){if(Array.isArray(e))return tt(e)}function nn(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function sn(e,t){if(e){if(typeof e=="string")return tt(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return tt(e,t)}}function tt(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function on(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var an=Object.prototype.toString,Ie=new ne;Ie.useLongestToken=!0;Ie.tokenize=ct.tokenize;Ie.castInput=function(e){var t=this.options,r=t.undefinedReplacement,n=t.stringifyReplacer,i=n===void 0?function(s,c){return typeof c>"u"?r:c}:n;return typeof e=="string"?e:JSON.stringify(rt(e,null,null,i),i,"  ")};Ie.equals=function(e,t){return ne.prototype.equals.call(Ie,e.replace(/,([\r\n])/g,"$1"),t.replace(/,([\r\n])/g,"$1"))};function rt(e,t,r,n,i){t=t||[],r=r||[],n&&(e=n(i,e));var s;for(s=0;s<t.length;s+=1)if(t[s]===e)return r[s];var c;if(an.call(e)==="[object Array]"){for(t.push(e),c=new Array(e.length),r.push(c),s=0;s<e.length;s+=1)c[s]=rt(e[s],t,r,n,i);return t.pop(),r.pop(),c}if(e&&e.toJSON&&(e=e.toJSON()),xe(e)==="object"&&e!==null){t.push(e),c={},r.push(c);var h=[],a;for(a in e)e.hasOwnProperty(a)&&h.push(a);for(h.sort(),s=0;s<h.length;s+=1)a=h[s],c[a]=rt(e[a],t,r,n,a);t.pop(),r.pop()}else c=e;return c}var nt=new ne;nt.tokenize=function(e){return e.slice()};nt.join=nt.removeEmpty=function(e){return e};function un(e,t,r,n,i,s,c){c||(c={}),typeof c.context>"u"&&(c.context=4);var h=Zr(r,n,c);if(!h)return;h.push({value:"",lines:[]});function a(T){return T.map(function(O){return" "+O})}for(var u=[],o=0,l=0,v=[],p=1,m=1,S=function(O){var N=h[O],_=N.lines||N.value.replace(/\n$/,"").split(`
`);if(N.lines=_,N.added||N.removed){var W;if(!o){var H=h[O-1];o=p,l=m,H&&(v=c.context>0?a(H.lines.slice(-c.context)):[],o-=v.length,l-=v.length)}(W=v).push.apply(W,We(_.map(function(d){return(N.added?"+":"-")+d}))),N.added?m+=_.length:p+=_.length}else{if(o)if(_.length<=c.context*2&&O<h.length-2){var te;(te=v).push.apply(te,We(a(_)))}else{var X,I=Math.min(_.length,c.context);(X=v).push.apply(X,We(a(_.slice(0,I))));var L={oldStart:o,oldLines:p-o+I,newStart:l,newLines:m-l+I,lines:v};if(O>=h.length-2&&_.length<=c.context){var A=/\n$/.test(r),F=/\n$/.test(n),f=_.length==0&&v.length>L.oldLines;!A&&f&&r.length>0&&v.splice(L.oldLines,0,"\\ No newline at end of file"),(!A&&!f||!F)&&v.push("\\ No newline at end of file")}u.push(L),o=0,l=0,v=[]}p+=_.length,m+=_.length}},R=0;R<h.length;R++)S(R);return{oldFileName:e,newFileName:t,oldHeader:i,newHeader:s,hunks:u}}function cn(e){var t=[];e.oldFileName==e.newFileName&&t.push("Index: "+e.oldFileName),t.push("==================================================================="),t.push("--- "+e.oldFileName+(typeof e.oldHeader>"u"?"":"	"+e.oldHeader)),t.push("+++ "+e.newFileName+(typeof e.newHeader>"u"?"":"	"+e.newHeader));for(var r=0;r<e.hunks.length;r++){var n=e.hunks[r];n.oldLines===0&&(n.oldStart-=1),n.newLines===0&&(n.newStart-=1),t.push("@@ -"+n.oldStart+","+n.oldLines+" +"+n.newStart+","+n.newLines+" @@"),t.push.apply(t,n.lines)}return t.join(`
`)+`
`}function ln(e,t,r,n,i,s,c){return cn(un(e,t,r,n,i,s,c))}var it={exports:{}};const fn="2.0.0",nr=256,hn=Number.MAX_SAFE_INTEGER||9007199254740991,pn=16,dn=nr-6,mn=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ge={MAX_LENGTH:nr,MAX_SAFE_COMPONENT_LENGTH:pn,MAX_SAFE_BUILD_LENGTH:dn,MAX_SAFE_INTEGER:hn,RELEASE_TYPES:mn,SEMVER_SPEC_VERSION:fn,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2};const vn=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Ue=vn;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:r,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:i}=Ge,s=Ue;t=e.exports={};const c=t.re=[],h=t.safeRe=[],a=t.src=[],u=t.t={};let o=0;const l="[a-zA-Z0-9-]",v=[["\\s",1],["\\d",i],[l,n]],p=S=>{for(const[R,T]of v)S=S.split(`${R}*`).join(`${R}{0,${T}}`).split(`${R}+`).join(`${R}{1,${T}}`);return S},m=(S,R,T)=>{const O=p(R),N=o++;s(S,N,R),u[S]=N,a[N]=R,c[N]=new RegExp(R,T?"g":void 0),h[N]=new RegExp(O,T?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${l}*`),m("MAINVERSION",`(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})\\.(${a[u.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})\\.(${a[u.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${a[u.NUMERICIDENTIFIER]}|${a[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${a[u.NUMERICIDENTIFIERLOOSE]}|${a[u.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${a[u.PRERELEASEIDENTIFIER]}(?:\\.${a[u.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${a[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${a[u.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${l}+`),m("BUILD",`(?:\\+(${a[u.BUILDIDENTIFIER]}(?:\\.${a[u.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${a[u.MAINVERSION]}${a[u.PRERELEASE]}?${a[u.BUILD]}?`),m("FULL",`^${a[u.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${a[u.MAINVERSIONLOOSE]}${a[u.PRERELEASELOOSE]}?${a[u.BUILD]}?`),m("LOOSE",`^${a[u.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${a[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${a[u.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:\\.(${a[u.XRANGEIDENTIFIER]})(?:${a[u.PRERELEASE]})?${a[u.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${a[u.XRANGEIDENTIFIERLOOSE]})(?:${a[u.PRERELEASELOOSE]})?${a[u.BUILD]}?)?)?`),m("XRANGE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${a[u.GTLT]}\\s*${a[u.XRANGEPLAINLOOSE]}$`),m("COERCE",`(^|[^\\d])(\\d{1,${r}})(?:\\.(\\d{1,${r}}))?(?:\\.(\\d{1,${r}}))?(?:$|[^\\d])`),m("COERCERTL",a[u.COERCE],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${a[u.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",m("TILDE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${a[u.LONETILDE]}${a[u.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${a[u.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",m("CARET",`^${a[u.LONECARET]}${a[u.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${a[u.LONECARET]}${a[u.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${a[u.GTLT]}\\s*(${a[u.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${a[u.GTLT]}\\s*(${a[u.LOOSEPLAIN]}|${a[u.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${a[u.XRANGEPLAIN]})\\s+-\\s+(${a[u.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${a[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${a[u.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(it,it.exports);var Te=it.exports;const gn=Object.freeze({loose:!0}),En=Object.freeze({}),$n=e=>e?typeof e!="object"?gn:e:En;var lt=$n;const It=/^[0-9]+$/,ir=(e,t)=>{const r=It.test(e),n=It.test(t);return r&&n&&(e=+e,t=+t),e===t?0:r&&!n?-1:n&&!r?1:e<t?-1:1},yn=(e,t)=>ir(t,e);var sr={compareIdentifiers:ir,rcompareIdentifiers:yn};const be=Ue,{MAX_LENGTH:Ot,MAX_SAFE_INTEGER:Ce}=Ge,{safeRe:Tt,t:Nt}=Te,wn=lt,{compareIdentifiers:fe}=sr;let Sn=class Q{constructor(t,r){if(r=wn(r),t instanceof Q){if(t.loose===!!r.loose&&t.includePrerelease===!!r.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Ot)throw new TypeError(`version is longer than ${Ot} characters`);be("SemVer",t,r),this.options=r,this.loose=!!r.loose,this.includePrerelease=!!r.includePrerelease;const n=t.trim().match(r.loose?Tt[Nt.LOOSE]:Tt[Nt.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Ce||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Ce||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Ce||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){const s=+i;if(s>=0&&s<Ce)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(be("SemVer.compare",this.version,this.options,t),!(t instanceof Q)){if(typeof t=="string"&&t===this.version)return 0;t=new Q(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Q||(t=new Q(t,this.options)),fe(this.major,t.major)||fe(this.minor,t.minor)||fe(this.patch,t.patch)}comparePre(t){if(t instanceof Q||(t=new Q(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let r=0;do{const n=this.prerelease[r],i=t.prerelease[r];if(be("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return fe(n,i)}while(++r)}compareBuild(t){t instanceof Q||(t=new Q(t,this.options));let r=0;do{const n=this.build[r],i=t.build[r];if(be("prerelease compare",r,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return fe(n,i)}while(++r)}inc(t,r,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",r,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",r,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",r,n),this.inc("pre",r,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",r,n),this.inc("pre",r,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const i=Number(n)?1:0;if(!r&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(r===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(r){let s=[r,i];n===!1&&(s=[r]),fe(this.prerelease[0],r)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var V=Sn;const Lt=V,Rn=(e,t,r=!1)=>{if(e instanceof Lt)return e;try{return new Lt(e,t)}catch(n){if(!r)return null;throw n}};var Ee=Rn;const In=Ee,On=(e,t)=>{const r=In(e,t);return r?r.version:null};var Tn=On;const Nn=Ee,Ln=(e,t)=>{const r=Nn(e.trim().replace(/^[=v]+/,""),t);return r?r.version:null};var An=Ln;const At=V,bn=(e,t,r,n,i)=>{typeof r=="string"&&(i=n,n=r,r=void 0);try{return new At(e instanceof At?e.version:e,r).inc(t,n,i).version}catch{return null}};var Cn=bn;const bt=Ee,Dn=(e,t)=>{const r=bt(e,null,!0),n=bt(t,null,!0),i=r.compare(n);if(i===0)return null;const s=i>0,c=s?r:n,h=s?n:r,a=!!c.prerelease.length;if(!!h.prerelease.length&&!a)return!h.patch&&!h.minor?"major":c.patch?"patch":c.minor?"minor":"major";const o=a?"pre":"";return r.major!==n.major?o+"major":r.minor!==n.minor?o+"minor":r.patch!==n.patch?o+"patch":"prerelease"};var _n=Dn;const Fn=V,xn=(e,t)=>new Fn(e,t).major;var Pn=xn;const jn=V,Gn=(e,t)=>new jn(e,t).minor;var Un=Gn;const qn=V,Mn=(e,t)=>new qn(e,t).patch;var Vn=Mn;const Wn=Ee,Xn=(e,t)=>{const r=Wn(e,t);return r&&r.prerelease.length?r.prerelease:null};var kn=Xn;const Ct=V,Hn=(e,t,r)=>new Ct(e,r).compare(new Ct(t,r));var z=Hn;const Yn=z,zn=(e,t,r)=>Yn(t,e,r);var Bn=zn;const Qn=z,Jn=(e,t)=>Qn(e,t,!0);var Kn=Jn;const Dt=V,Zn=(e,t,r)=>{const n=new Dt(e,r),i=new Dt(t,r);return n.compare(i)||n.compareBuild(i)};var ft=Zn;const ei=ft,ti=(e,t)=>e.sort((r,n)=>ei(r,n,t));var ri=ti;const ni=ft,ii=(e,t)=>e.sort((r,n)=>ni(n,r,t));var si=ii;const oi=z,ai=(e,t,r)=>oi(e,t,r)>0;var qe=ai;const ui=z,ci=(e,t,r)=>ui(e,t,r)<0;var ht=ci;const li=z,fi=(e,t,r)=>li(e,t,r)===0;var or=fi;const hi=z,pi=(e,t,r)=>hi(e,t,r)!==0;var ar=pi;const di=z,mi=(e,t,r)=>di(e,t,r)>=0;var pt=mi;const vi=z,gi=(e,t,r)=>vi(e,t,r)<=0;var dt=gi;const Ei=or,$i=ar,yi=qe,wi=pt,Si=ht,Ri=dt,Ii=(e,t,r,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e===r;case"!==":return typeof e=="object"&&(e=e.version),typeof r=="object"&&(r=r.version),e!==r;case"":case"=":case"==":return Ei(e,r,n);case"!=":return $i(e,r,n);case">":return yi(e,r,n);case">=":return wi(e,r,n);case"<":return Si(e,r,n);case"<=":return Ri(e,r,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var ur=Ii;const Oi=V,Ti=Ee,{safeRe:De,t:_e}=Te,Ni=(e,t)=>{if(e instanceof Oi)return e;if(typeof e=="number"&&(e=String(e)),typeof e!="string")return null;t=t||{};let r=null;if(!t.rtl)r=e.match(De[_e.COERCE]);else{let n;for(;(n=De[_e.COERCERTL].exec(e))&&(!r||r.index+r[0].length!==e.length);)(!r||n.index+n[0].length!==r.index+r[0].length)&&(r=n),De[_e.COERCERTL].lastIndex=n.index+n[1].length+n[2].length;De[_e.COERCERTL].lastIndex=-1}return r===null?null:Ti(`${r[2]}.${r[3]||"0"}.${r[4]||"0"}`,t)};var Li=Ni,Xe,_t;function Ai(){return _t||(_t=1,Xe=function(e){e.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Xe}var bi=D;D.Node=ce;D.create=D;function D(e){var t=this;if(t instanceof D||(t=new D),t.tail=null,t.head=null,t.length=0,e&&typeof e.forEach=="function")e.forEach(function(i){t.push(i)});else if(arguments.length>0)for(var r=0,n=arguments.length;r<n;r++)t.push(arguments[r]);return t}D.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,r=e.prev;return t&&(t.prev=r),r&&(r.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=r),e.list.length--,e.next=null,e.prev=null,e.list=null,t};D.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}};D.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}};D.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)Di(this,arguments[e]);return this.length};D.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)_i(this,arguments[e]);return this.length};D.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}};D.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}};D.prototype.forEach=function(e,t){t=t||this;for(var r=this.head,n=0;r!==null;n++)e.call(t,r.value,n,this),r=r.next};D.prototype.forEachReverse=function(e,t){t=t||this;for(var r=this.tail,n=this.length-1;r!==null;n--)e.call(t,r.value,n,this),r=r.prev};D.prototype.get=function(e){for(var t=0,r=this.head;r!==null&&t<e;t++)r=r.next;if(t===e&&r!==null)return r.value};D.prototype.getReverse=function(e){for(var t=0,r=this.tail;r!==null&&t<e;t++)r=r.prev;if(t===e&&r!==null)return r.value};D.prototype.map=function(e,t){t=t||this;for(var r=new D,n=this.head;n!==null;)r.push(e.call(t,n.value,this)),n=n.next;return r};D.prototype.mapReverse=function(e,t){t=t||this;for(var r=new D,n=this.tail;n!==null;)r.push(e.call(t,n.value,this)),n=n.prev;return r};D.prototype.reduce=function(e,t){var r,n=this.head;if(arguments.length>1)r=t;else if(this.head)n=this.head.next,r=this.head.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=0;n!==null;i++)r=e(r,n.value,i),n=n.next;return r};D.prototype.reduceReverse=function(e,t){var r,n=this.tail;if(arguments.length>1)r=t;else if(this.tail)n=this.tail.prev,r=this.tail.value;else throw new TypeError("Reduce of empty list with no initial value");for(var i=this.length-1;n!==null;i--)r=e(r,n.value,i),n=n.prev;return r};D.prototype.toArray=function(){for(var e=new Array(this.length),t=0,r=this.head;r!==null;t++)e[t]=r.value,r=r.next;return e};D.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,r=this.tail;r!==null;t++)e[t]=r.value,r=r.prev;return e};D.prototype.slice=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new D;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(;i!==null&&n<t;n++,i=i.next)r.push(i.value);return r};D.prototype.sliceReverse=function(e,t){t=t||this.length,t<0&&(t+=this.length),e=e||0,e<0&&(e+=this.length);var r=new D;if(t<e||t<0)return r;e<0&&(e=0),t>this.length&&(t=this.length);for(var n=this.length,i=this.tail;i!==null&&n>t;n--)i=i.prev;for(;i!==null&&n>e;n--,i=i.prev)r.push(i.value);return r};D.prototype.splice=function(e,t,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var n=0,i=this.head;i!==null&&n<e;n++)i=i.next;for(var s=[],n=0;i&&n<t;n++)s.push(i.value),i=this.removeNode(i);i===null&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev);for(var n=0;n<r.length;n++)i=Ci(this,i,r[n]);return s};D.prototype.reverse=function(){for(var e=this.head,t=this.tail,r=e;r!==null;r=r.prev){var n=r.prev;r.prev=r.next,r.next=n}return this.head=t,this.tail=e,this};function Ci(e,t,r){var n=t===e.head?new ce(r,null,t,e):new ce(r,t,t.next,e);return n.next===null&&(e.tail=n),n.prev===null&&(e.head=n),e.length++,n}function Di(e,t){e.tail=new ce(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function _i(e,t){e.head=new ce(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function ce(e,t,r,n){if(!(this instanceof ce))return new ce(e,t,r,n);this.list=n,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,r?(r.prev=this,this.next=r):this.next=null}try{Ai()(D)}catch{}const Fi=bi,ie=Symbol("max"),Z=Symbol("length"),he=Symbol("lengthCalculator"),Re=Symbol("allowStale"),se=Symbol("maxAge"),K=Symbol("dispose"),Ft=Symbol("noDisposeOnSet"),U=Symbol("lruList"),Y=Symbol("cache"),cr=Symbol("updateAgeOnGet"),ke=()=>1;class xi{constructor(t){if(typeof t=="number"&&(t={max:t}),t||(t={}),t.max&&(typeof t.max!="number"||t.max<0))throw new TypeError("max must be a non-negative number");this[ie]=t.max||1/0;const r=t.length||ke;if(this[he]=typeof r!="function"?ke:r,this[Re]=t.stale||!1,t.maxAge&&typeof t.maxAge!="number")throw new TypeError("maxAge must be a number");this[se]=t.maxAge||0,this[K]=t.dispose,this[Ft]=t.noDisposeOnSet||!1,this[cr]=t.updateAgeOnGet||!1,this.reset()}set max(t){if(typeof t!="number"||t<0)throw new TypeError("max must be a non-negative number");this[ie]=t||1/0,we(this)}get max(){return this[ie]}set allowStale(t){this[Re]=!!t}get allowStale(){return this[Re]}set maxAge(t){if(typeof t!="number")throw new TypeError("maxAge must be a non-negative number");this[se]=t,we(this)}get maxAge(){return this[se]}set lengthCalculator(t){typeof t!="function"&&(t=ke),t!==this[he]&&(this[he]=t,this[Z]=0,this[U].forEach(r=>{r.length=this[he](r.value,r.key),this[Z]+=r.length})),we(this)}get lengthCalculator(){return this[he]}get length(){return this[Z]}get itemCount(){return this[U].length}rforEach(t,r){r=r||this;for(let n=this[U].tail;n!==null;){const i=n.prev;xt(this,t,n,r),n=i}}forEach(t,r){r=r||this;for(let n=this[U].head;n!==null;){const i=n.next;xt(this,t,n,r),n=i}}keys(){return this[U].toArray().map(t=>t.key)}values(){return this[U].toArray().map(t=>t.value)}reset(){this[K]&&this[U]&&this[U].length&&this[U].forEach(t=>this[K](t.key,t.value)),this[Y]=new Map,this[U]=new Fi,this[Z]=0}dump(){return this[U].map(t=>je(this,t)?!1:{k:t.key,v:t.value,e:t.now+(t.maxAge||0)}).toArray().filter(t=>t)}dumpLru(){return this[U]}set(t,r,n){if(n=n||this[se],n&&typeof n!="number")throw new TypeError("maxAge must be a number");const i=n?Date.now():0,s=this[he](r,t);if(this[Y].has(t)){if(s>this[ie])return me(this,this[Y].get(t)),!1;const a=this[Y].get(t).value;return this[K]&&(this[Ft]||this[K](t,a.value)),a.now=i,a.maxAge=n,a.value=r,this[Z]+=s-a.length,a.length=s,this.get(t),we(this),!0}const c=new Pi(t,r,s,i,n);return c.length>this[ie]?(this[K]&&this[K](t,r),!1):(this[Z]+=c.length,this[U].unshift(c),this[Y].set(t,this[U].head),we(this),!0)}has(t){if(!this[Y].has(t))return!1;const r=this[Y].get(t).value;return!je(this,r)}get(t){return He(this,t,!0)}peek(t){return He(this,t,!1)}pop(){const t=this[U].tail;return t?(me(this,t),t.value):null}del(t){me(this,this[Y].get(t))}load(t){this.reset();const r=Date.now();for(let n=t.length-1;n>=0;n--){const i=t[n],s=i.e||0;if(s===0)this.set(i.k,i.v);else{const c=s-r;c>0&&this.set(i.k,i.v,c)}}}prune(){this[Y].forEach((t,r)=>He(this,r,!1))}}const He=(e,t,r)=>{const n=e[Y].get(t);if(n){const i=n.value;if(je(e,i)){if(me(e,n),!e[Re])return}else r&&(e[cr]&&(n.value.now=Date.now()),e[U].unshiftNode(n));return i.value}},je=(e,t)=>{if(!t||!t.maxAge&&!e[se])return!1;const r=Date.now()-t.now;return t.maxAge?r>t.maxAge:e[se]&&r>e[se]},we=e=>{if(e[Z]>e[ie])for(let t=e[U].tail;e[Z]>e[ie]&&t!==null;){const r=t.prev;me(e,t),t=r}},me=(e,t)=>{if(t){const r=t.value;e[K]&&e[K](r.key,r.value),e[Z]-=r.length,e[Y].delete(r.key),e[U].removeNode(t)}};class Pi{constructor(t,r,n,i,s){this.key=t,this.value=r,this.length=n,this.now=i,this.maxAge=s||0}}const xt=(e,t,r,n)=>{let i=r.value;je(e,i)&&(me(e,r),e[Re]||(i=void 0)),i&&t.call(n,i.value,i.key,e)};var ji=xi,Ye,Pt;function B(){if(Pt)return Ye;Pt=1;class e{constructor(d,$){if($=n($),d instanceof e)return d.loose===!!$.loose&&d.includePrerelease===!!$.includePrerelease?d:new e(d.raw,$);if(d instanceof i)return this.raw=d.value,this.set=[[d]],this.format(),this;if(this.options=$,this.loose=!!$.loose,this.includePrerelease=!!$.includePrerelease,this.raw=d.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map(y=>this.parseRange(y.trim())).filter(y=>y.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const y=this.set[0];if(this.set=this.set.filter(E=>!m(E[0])),this.set.length===0)this.set=[y];else if(this.set.length>1){for(const E of this.set)if(E.length===1&&S(E[0])){this.set=[E];break}}}this.format()}format(){return this.range=this.set.map(d=>d.join(" ").trim()).join("||").trim(),this.range}toString(){return this.range}parseRange(d){const y=((this.options.includePrerelease&&v)|(this.options.loose&&p))+":"+d,E=r.get(y);if(E)return E;const g=this.options.loose,w=g?h[a.HYPHENRANGELOOSE]:h[a.HYPHENRANGE];d=d.replace(w,A(this.options.includePrerelease)),s("hyphen replace",d),d=d.replace(h[a.COMPARATORTRIM],u),s("comparator trim",d),d=d.replace(h[a.TILDETRIM],o),s("tilde trim",d),d=d.replace(h[a.CARETTRIM],l),s("caret trim",d);let C=d.split(" ").map(G=>T(G,this.options)).join(" ").split(/\s+/).map(G=>L(G,this.options));g&&(C=C.filter(G=>(s("loose invalid filter",G,this.options),!!G.match(h[a.COMPARATORLOOSE])))),s("range list",C);const b=new Map,x=C.map(G=>new i(G,this.options));for(const G of x){if(m(G))return[G];b.set(G.value,G)}b.size>1&&b.has("")&&b.delete("");const k=[...b.values()];return r.set(y,k),k}intersects(d,$){if(!(d instanceof e))throw new TypeError("a Range is required");return this.set.some(y=>R(y,$)&&d.set.some(E=>R(E,$)&&y.every(g=>E.every(w=>g.intersects(w,$)))))}test(d){if(!d)return!1;if(typeof d=="string")try{d=new c(d,this.options)}catch{return!1}for(let $=0;$<this.set.length;$++)if(F(this.set[$],d,this.options))return!0;return!1}}Ye=e;const t=ji,r=new t({max:1e3}),n=lt,i=Me(),s=Ue,c=V,{safeRe:h,t:a,comparatorTrimReplace:u,tildeTrimReplace:o,caretTrimReplace:l}=Te,{FLAG_INCLUDE_PRERELEASE:v,FLAG_LOOSE:p}=Ge,m=f=>f.value==="<0.0.0-0",S=f=>f.value==="",R=(f,d)=>{let $=!0;const y=f.slice();let E=y.pop();for(;$&&y.length;)$=y.every(g=>E.intersects(g,d)),E=y.pop();return $},T=(f,d)=>(s("comp",f,d),f=W(f,d),s("caret",f),f=N(f,d),s("tildes",f),f=te(f,d),s("xrange",f),f=I(f,d),s("stars",f),f),O=f=>!f||f.toLowerCase()==="x"||f==="*",N=(f,d)=>f.trim().split(/\s+/).map($=>_($,d)).join(" "),_=(f,d)=>{const $=d.loose?h[a.TILDELOOSE]:h[a.TILDE];return f.replace($,(y,E,g,w,C)=>{s("tilde",f,y,E,g,w,C);let b;return O(E)?b="":O(g)?b=`>=${E}.0.0 <${+E+1}.0.0-0`:O(w)?b=`>=${E}.${g}.0 <${E}.${+g+1}.0-0`:C?(s("replaceTilde pr",C),b=`>=${E}.${g}.${w}-${C} <${E}.${+g+1}.0-0`):b=`>=${E}.${g}.${w} <${E}.${+g+1}.0-0`,s("tilde return",b),b})},W=(f,d)=>f.trim().split(/\s+/).map($=>H($,d)).join(" "),H=(f,d)=>{s("caret",f,d);const $=d.loose?h[a.CARETLOOSE]:h[a.CARET],y=d.includePrerelease?"-0":"";return f.replace($,(E,g,w,C,b)=>{s("caret",f,E,g,w,C,b);let x;return O(g)?x="":O(w)?x=`>=${g}.0.0${y} <${+g+1}.0.0-0`:O(C)?g==="0"?x=`>=${g}.${w}.0${y} <${g}.${+w+1}.0-0`:x=`>=${g}.${w}.0${y} <${+g+1}.0.0-0`:b?(s("replaceCaret pr",b),g==="0"?w==="0"?x=`>=${g}.${w}.${C}-${b} <${g}.${w}.${+C+1}-0`:x=`>=${g}.${w}.${C}-${b} <${g}.${+w+1}.0-0`:x=`>=${g}.${w}.${C}-${b} <${+g+1}.0.0-0`):(s("no pr"),g==="0"?w==="0"?x=`>=${g}.${w}.${C}${y} <${g}.${w}.${+C+1}-0`:x=`>=${g}.${w}.${C}${y} <${g}.${+w+1}.0-0`:x=`>=${g}.${w}.${C} <${+g+1}.0.0-0`),s("caret return",x),x})},te=(f,d)=>(s("replaceXRanges",f,d),f.split(/\s+/).map($=>X($,d)).join(" ")),X=(f,d)=>{f=f.trim();const $=d.loose?h[a.XRANGELOOSE]:h[a.XRANGE];return f.replace($,(y,E,g,w,C,b)=>{s("xRange",f,y,E,g,w,C,b);const x=O(g),k=x||O(w),G=k||O(C),$e=G;return E==="="&&$e&&(E=""),b=d.includePrerelease?"-0":"",x?E===">"||E==="<"?y="<0.0.0-0":y="*":E&&$e?(k&&(w=0),C=0,E===">"?(E=">=",k?(g=+g+1,w=0,C=0):(w=+w+1,C=0)):E==="<="&&(E="<",k?g=+g+1:w=+w+1),E==="<"&&(b="-0"),y=`${E+g}.${w}.${C}${b}`):k?y=`>=${g}.0.0${b} <${+g+1}.0.0-0`:G&&(y=`>=${g}.${w}.0${b} <${g}.${+w+1}.0-0`),s("xRange return",y),y})},I=(f,d)=>(s("replaceStars",f,d),f.trim().replace(h[a.STAR],"")),L=(f,d)=>(s("replaceGTE0",f,d),f.trim().replace(h[d.includePrerelease?a.GTE0PRE:a.GTE0],"")),A=f=>(d,$,y,E,g,w,C,b,x,k,G,$e,sa)=>(O(y)?$="":O(E)?$=`>=${y}.0.0${f?"-0":""}`:O(g)?$=`>=${y}.${E}.0${f?"-0":""}`:w?$=`>=${$}`:$=`>=${$}${f?"-0":""}`,O(x)?b="":O(k)?b=`<${+x+1}.0.0-0`:O(G)?b=`<${x}.${+k+1}.0-0`:$e?b=`<=${x}.${k}.${G}-${$e}`:f?b=`<${x}.${k}.${+G+1}-0`:b=`<=${b}`,`${$} ${b}`.trim()),F=(f,d,$)=>{for(let y=0;y<f.length;y++)if(!f[y].test(d))return!1;if(d.prerelease.length&&!$.includePrerelease){for(let y=0;y<f.length;y++)if(s(f[y].semver),f[y].semver!==i.ANY&&f[y].semver.prerelease.length>0){const E=f[y].semver;if(E.major===d.major&&E.minor===d.minor&&E.patch===d.patch)return!0}return!1}return!0};return Ye}var ze,jt;function Me(){if(jt)return ze;jt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(o,l){if(l=r(l),o instanceof t){if(o.loose===!!l.loose)return o;o=o.value}o=o.trim().split(/\s+/).join(" "),c("comparator",o,l),this.options=l,this.loose=!!l.loose,this.parse(o),this.semver===e?this.value="":this.value=this.operator+this.semver.version,c("comp",this)}parse(o){const l=this.options.loose?n[i.COMPARATORLOOSE]:n[i.COMPARATOR],v=o.match(l);if(!v)throw new TypeError(`Invalid comparator: ${o}`);this.operator=v[1]!==void 0?v[1]:"",this.operator==="="&&(this.operator=""),v[2]?this.semver=new h(v[2],this.options.loose):this.semver=e}toString(){return this.value}test(o){if(c("Comparator.test",o,this.options.loose),this.semver===e||o===e)return!0;if(typeof o=="string")try{o=new h(o,this.options)}catch{return!1}return s(o,this.operator,this.semver,this.options)}intersects(o,l){if(!(o instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new a(o.value,l).test(this.value):o.operator===""?o.value===""?!0:new a(this.value,l).test(o.semver):(l=r(l),l.includePrerelease&&(this.value==="<0.0.0-0"||o.value==="<0.0.0-0")||!l.includePrerelease&&(this.value.startsWith("<0.0.0")||o.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&o.operator.startsWith(">")||this.operator.startsWith("<")&&o.operator.startsWith("<")||this.semver.version===o.semver.version&&this.operator.includes("=")&&o.operator.includes("=")||s(this.semver,"<",o.semver,l)&&this.operator.startsWith(">")&&o.operator.startsWith("<")||s(this.semver,">",o.semver,l)&&this.operator.startsWith("<")&&o.operator.startsWith(">")))}}ze=t;const r=lt,{safeRe:n,t:i}=Te,s=ur,c=Ue,h=V,a=B();return ze}const Gi=B(),Ui=(e,t,r)=>{try{t=new Gi(t,r)}catch{return!1}return t.test(e)};var Ve=Ui;const qi=B(),Mi=(e,t)=>new qi(e,t).set.map(r=>r.map(n=>n.value).join(" ").trim().split(" "));var Vi=Mi;const Wi=V,Xi=B(),ki=(e,t,r)=>{let n=null,i=null,s=null;try{s=new Xi(t,r)}catch{return null}return e.forEach(c=>{s.test(c)&&(!n||i.compare(c)===-1)&&(n=c,i=new Wi(n,r))}),n};var Hi=ki;const Yi=V,zi=B(),Bi=(e,t,r)=>{let n=null,i=null,s=null;try{s=new zi(t,r)}catch{return null}return e.forEach(c=>{s.test(c)&&(!n||i.compare(c)===1)&&(n=c,i=new Yi(n,r))}),n};var Qi=Bi;const Be=V,Ji=B(),Gt=qe,Ki=(e,t)=>{e=new Ji(e,t);let r=new Be("0.0.0");if(e.test(r)||(r=new Be("0.0.0-0"),e.test(r)))return r;r=null;for(let n=0;n<e.set.length;++n){const i=e.set[n];let s=null;i.forEach(c=>{const h=new Be(c.semver.version);switch(c.operator){case">":h.prerelease.length===0?h.patch++:h.prerelease.push(0),h.raw=h.format();case"":case">=":(!s||Gt(h,s))&&(s=h);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${c.operator}`)}}),s&&(!r||Gt(r,s))&&(r=s)}return r&&e.test(r)?r:null};var Zi=Ki;const es=B(),ts=(e,t)=>{try{return new es(e,t).range||"*"}catch{return null}};var rs=ts;const ns=V,lr=Me(),{ANY:is}=lr,ss=B(),os=Ve,Ut=qe,qt=ht,as=dt,us=pt,cs=(e,t,r,n)=>{e=new ns(e,n),t=new ss(t,n);let i,s,c,h,a;switch(r){case">":i=Ut,s=as,c=qt,h=">",a=">=";break;case"<":i=qt,s=us,c=Ut,h="<",a="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(os(e,t,n))return!1;for(let u=0;u<t.set.length;++u){const o=t.set[u];let l=null,v=null;if(o.forEach(p=>{p.semver===is&&(p=new lr(">=0.0.0")),l=l||p,v=v||p,i(p.semver,l.semver,n)?l=p:c(p.semver,v.semver,n)&&(v=p)}),l.operator===h||l.operator===a||(!v.operator||v.operator===h)&&s(e,v.semver))return!1;if(v.operator===a&&c(e,v.semver))return!1}return!0};var mt=cs;const ls=mt,fs=(e,t,r)=>ls(e,t,">",r);var hs=fs;const ps=mt,ds=(e,t,r)=>ps(e,t,"<",r);var ms=ds;const Mt=B(),vs=(e,t,r)=>(e=new Mt(e,r),t=new Mt(t,r),e.intersects(t,r));var gs=vs;const Es=Ve,$s=z;var ys=(e,t,r)=>{const n=[];let i=null,s=null;const c=e.sort((o,l)=>$s(o,l,r));for(const o of c)Es(o,t,r)?(s=o,i||(i=o)):(s&&n.push([i,s]),s=null,i=null);i&&n.push([i,null]);const h=[];for(const[o,l]of n)o===l?h.push(o):!l&&o===c[0]?h.push("*"):l?o===c[0]?h.push(`<=${l}`):h.push(`${o} - ${l}`):h.push(`>=${o}`);const a=h.join(" || "),u=typeof t.raw=="string"?t.raw:String(t);return a.length<u.length?a:t};const Vt=B(),vt=Me(),{ANY:Qe}=vt,Se=Ve,gt=z,ws=(e,t,r={})=>{if(e===t)return!0;e=new Vt(e,r),t=new Vt(t,r);let n=!1;e:for(const i of e.set){for(const s of t.set){const c=Rs(i,s,r);if(n=n||c!==null,c)continue e}if(n)return!1}return!0},Ss=[new vt(">=0.0.0-0")],Wt=[new vt(">=0.0.0")],Rs=(e,t,r)=>{if(e===t)return!0;if(e.length===1&&e[0].semver===Qe){if(t.length===1&&t[0].semver===Qe)return!0;r.includePrerelease?e=Ss:e=Wt}if(t.length===1&&t[0].semver===Qe){if(r.includePrerelease)return!0;t=Wt}const n=new Set;let i,s;for(const p of e)p.operator===">"||p.operator===">="?i=Xt(i,p,r):p.operator==="<"||p.operator==="<="?s=kt(s,p,r):n.add(p.semver);if(n.size>1)return null;let c;if(i&&s){if(c=gt(i.semver,s.semver,r),c>0)return null;if(c===0&&(i.operator!==">="||s.operator!=="<="))return null}for(const p of n){if(i&&!Se(p,String(i),r)||s&&!Se(p,String(s),r))return null;for(const m of t)if(!Se(p,String(m),r))return!1;return!0}let h,a,u,o,l=s&&!r.includePrerelease&&s.semver.prerelease.length?s.semver:!1,v=i&&!r.includePrerelease&&i.semver.prerelease.length?i.semver:!1;l&&l.prerelease.length===1&&s.operator==="<"&&l.prerelease[0]===0&&(l=!1);for(const p of t){if(o=o||p.operator===">"||p.operator===">=",u=u||p.operator==="<"||p.operator==="<=",i){if(v&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===v.major&&p.semver.minor===v.minor&&p.semver.patch===v.patch&&(v=!1),p.operator===">"||p.operator===">="){if(h=Xt(i,p,r),h===p&&h!==i)return!1}else if(i.operator===">="&&!Se(i.semver,String(p),r))return!1}if(s){if(l&&p.semver.prerelease&&p.semver.prerelease.length&&p.semver.major===l.major&&p.semver.minor===l.minor&&p.semver.patch===l.patch&&(l=!1),p.operator==="<"||p.operator==="<="){if(a=kt(s,p,r),a===p&&a!==s)return!1}else if(s.operator==="<="&&!Se(s.semver,String(p),r))return!1}if(!p.operator&&(s||i)&&c!==0)return!1}return!(i&&u&&!s&&c!==0||s&&o&&!i&&c!==0||v||l)},Xt=(e,t,r)=>{if(!e)return t;const n=gt(e.semver,t.semver,r);return n>0?e:n<0||t.operator===">"&&e.operator===">="?t:e},kt=(e,t,r)=>{if(!e)return t;const n=gt(e.semver,t.semver,r);return n<0?e:n>0||t.operator==="<"&&e.operator==="<="?t:e};var Is=ws;const Je=Te,Ht=Ge,Os=V,Yt=sr,Ts=Ee,Ns=Tn,Ls=An,As=Cn,bs=_n,Cs=Pn,Ds=Un,_s=Vn,Fs=kn,xs=z,Ps=Bn,js=Kn,Gs=ft,Us=ri,qs=si,Ms=qe,Vs=ht,Ws=or,Xs=ar,ks=pt,Hs=dt,Ys=ur,zs=Li,Bs=Me(),Qs=B(),Js=Ve,Ks=Vi,Zs=Hi,eo=Qi,to=Zi,ro=rs,no=mt,io=hs,so=ms,oo=gs,ao=ys,uo=Is;var co={parse:Ts,valid:Ns,clean:Ls,inc:As,diff:bs,major:Cs,minor:Ds,patch:_s,prerelease:Fs,compare:xs,rcompare:Ps,compareLoose:js,compareBuild:Gs,sort:Us,rsort:qs,gt:Ms,lt:Vs,eq:Ws,neq:Xs,gte:ks,lte:Hs,cmp:Ys,coerce:zs,Comparator:Bs,Range:Qs,satisfies:Js,toComparators:Ks,maxSatisfying:Zs,minSatisfying:eo,minVersion:to,validRange:ro,outside:no,gtr:io,ltr:so,intersects:oo,simplifyRange:ao,subset:uo,SemVer:Os,re:Je.re,src:Je.src,tokens:Je.t,SEMVER_SPEC_VERSION:Ht.SEMVER_SPEC_VERSION,RELEASE_TYPES:Ht.RELEASE_TYPES,compareIdentifiers:Yt.compareIdentifiers,rcompareIdentifiers:Yt.rcompareIdentifiers};const zt=Zt(co);function M(e,t){return new Promise((r,n)=>e.write(`${t}
`,i=>{i?n(i):r()}))}function lo(e,t){const r=e instanceof ee?e.toString():e instanceof Error?e.stack||e.message:String(e);return fo(r,t)}function fo(e,t){const{indent:r}=t;return r+e.replace(/\n/g,`
`+r)}function ae(e,t){return fr("32",e,t)}function ho(e,t){return fr("31",e,t)}function fr(e,t,r){return r.NO_COLOR&&r.NO_COLOR!=="0"?t:`\x1B[${e}m${t}\x1B[0m`}class ee extends Error{constructor(r,n){super(r);ye(this,"info");this.name="CliError",this.info=n}toString(r){return`${r?ho("Error",r):"Error"}: ${this.message}

${this.info}`}}class J extends ee{constructor(t,r){super(t,r),this.name="CliArgsError"}}const po=ge.promisify(ue.readdir);ge.promisify(ue.readFile);ge.promisify(ue.writeFile);const hr=ge.promisify(ue.stat);function mo(e,t){return e instanceof Error&&e.code===t}async function pr(e,t){const r=await po(e);return Promise.all(r.map(n=>hr(P.join(e,n)).then(i=>{const s=P.join(e,n);return t(s,i)?i.isDirectory()?pr(s,t).then(c=>c.map(h=>P.join(n,h))):[n]:[]}))).then(n=>n.flat())}async function dr(e,t,r){const n=P.join(e,t),i=await(async()=>{try{return await hr(n)}catch(h){if(mo(h,"ENOENT"))return null;throw h}})();if(i)return!r||r(n,i)?e:null;const{dir:s,root:c}=P.parse(e);return e===c?null:dr(s,t,r)}function mr(e,t,r){return new Promise((n,i)=>{const s=br.spawn(e,t,{stdio:["ignore","pipe","pipe"],...r}),c=[],h=[];s.stdout.on("data",a=>c.push(a)),s.stderr.on("data",a=>h.push(a)),s.on("error",i),s.on("close",a=>{a===0?n({stdout:Buffer.concat(c).toString("utf8"),stderr:Buffer.concat(h).toString("utf8")}):i(new Error(`Command "${e} ${t.join(" ")}" exited with code ${a}`))})})}const vo=/^\s*([^ ]+)\s*(.*)$/;async function go(e){return dr(e,".git",(t,r)=>r.isDirectory())}async function Eo(e,t){const{gitRepository:r}=t,{stdout:n}=await mr("git",["ls-files","--exclude-standard","--",...e],{cwd:r});return n.split(`
`).filter(s=>s.length>0)}async function $o(e){const{stdout:t}=await mr("git",["status","--porcelain","--untracked-files=no"],{cwd:e});return t.split(`
`).filter(r=>r.length>0).map(r=>{const n=r.match(vo);return n?n[2]:null}).filter(de)}const yo="@ag-grid-community/cli",wo="31.2.0",So="MIT",Ro="AG Grid developer toolkit",Io="AG Grid <info@ag-grid.com>",Oo="https://www.ag-grid.com/",To={type:"git",url:"https://github.com/ag-grid/devtools.git"},No={url:"https://github.com/ag-grid/devtools/issues"},Lo="module",Ao="./index.ts",bo={build:"pnpm run build:lib && pnpm run build:codemods && pnpm run build:readme && pnpm run build:pkg","build:lib":"vite build","build:readme":"cp README.md dist/README.md","build:pkg":"pnpm run --filter build-tools pkg $PWD $PWD/dist/package.json","build:codemods":"pnpm run build:codemods:lib && pnpm run build:codemods:pkg","build:codemods:lib":"vite build --config codemods.vite.config.mts","build:codemods:pkg":"pnpm run --filter build-tools pkg $PWD/../codemods $PWD/dist/node_modules/@ag-grid-community/codemods/package.json",lint:"pnpm run '/^lint:.*/'","lint:eslint":"eslint --ext js,cjs,mjs,ts .","lint:typescript":"tsc --noEmit",test:"vitest run","test:watch":"vitest watch",version:`node -p -e "require('./package.json').version"`,publish:"npm publish ./dist --access public"},Co={main:"./index.cjs",bin:"./index.cjs"},Do=["@ag-grid-community/codemods"],_o={"@ag-grid-community/codemods":"workspace:*"},Fo={"@ag-grid-devtools/build-config":"workspace:*","@ag-grid-devtools/codemod-task-utils":"workspace:*","@ag-grid-devtools/types":"workspace:*","@ag-grid-devtools/utils":"workspace:*","@ag-grid-devtools/worker-utils":"workspace:*","@types/diff":"5.0.8","@types/graceful-fs":"4.1.9","@types/node":"20.11.29","@types/semver":"7.5.6",diff:"5.1.0","graceful-fs":"4.2.11",semver:"7.5.4"},xo={eslint:"^8",typedoc:"^0.25",typescript:"^5",vite:"^5",vitest:"^1"},Po={private:!0,name:yo,version:wo,license:So,description:Ro,author:Io,homepage:Oo,repository:To,bugs:No,type:Lo,main:Ao,scripts:bo,pkg:Co,bundleDependencies:Do,dependencies:_o,devDependencies:Fo,peerDependencies:xo},{name:jo,version:Go}=Po;function Uo(){return jo}function qo(){return Go.replace(/^(\d+\.\d+).+$/,"$1")}function vr(){return`npx ${Uo()}@${qo()}`}const ve={Idle:Object.assign(e=>Ke(0,e),{is:e=>Ze(e,0)}),Running:Object.assign(e=>Ke(1,e),{is:e=>Ze(e,1)})};class Mo{constructor(t){ye(this,"workers");ye(this,"queue",[]);ye(this,"terminated",!1);this.workers=t.map(r=>({worker:r,state:ve.Idle({})}))}run(t,r){if(this.terminated)throw new Error("This worker pool has been terminated");const{onQueue:n=void 0,onStart:i=void 0,onSuccess:s=void 0,onError:c=void 0,onComplete:h=void 0}=r||{},a=Date.now(),u=this.workers.map(l=>ve.Idle.is(l.state)?l:null).find(de),o={onQueue:n,onStart:i,onSuccess:s,onError:c,onComplete:h};return(u?Vo(u,t,a,o,this.queue):Wo(t,a,o,this.queue)).then(l=>{if(l.success)return l.value;throw l.error})}terminate(){if(!this.terminated){this.terminated=!0;for(const t of this.queue){const{resolver:r,onError:n,onComplete:i,queuedTime:s}=t;if(n||i){const c=Date.now(),a={queuedAt:s,startTime:c,endTime:c,runningTime:0,totalTime:0};n&&n(a),i&&i({success:!1,...a})}r&&r.reject(new Error("Worker terminated"))}for(const t of this.workers)t.state=ve.Idle({}),t.worker.terminate()}}}function Vo(e,t,r,n,i){const s=r;return e.state=ve.Running({input:t,resolver:void 0,queuedTime:r,startTime:s,onSuccess:n.onSuccess,onError:n.onError,onComplete:n.onComplete}),n.onStart&&n.onStart({queuedAt:r,startedAt:s}),gr(e,t,r,s,n,i)}function Wo(e,t,r,n){let i;const s=new Promise((o,l)=>{i={resolve:o,reject:l}});r.onQueue&&r.onQueue({queuedAt:t});const{onStart:c,onSuccess:h,onError:a,onComplete:u}=r;return n.push({input:e,queuedTime:t,resolver:i,onStart:c,onSuccess:h,onError:a,onComplete:u}),s}function gr(e,t,r,n,i,s){const{onSuccess:c,onError:h,onComplete:a}=i;return Xo(e.worker,t).then(u=>({success:!0,value:u}),u=>({success:!1,error:u})).then(u=>{const o=Date.now(),l={queuedAt:r,startTime:n,endTime:o,runningTime:o-n,totalTime:o-r};return u.success?{success:!0,value:u.value,stats:l}:{success:!1,error:u.error,stats:l}}).then(u=>{const o=s.shift();if(o){const{input:v,queuedTime:p,resolver:m,onStart:S,onSuccess:R,onError:T,onComplete:O}=o,N=Date.now();e.state=ve.Running({input:v,resolver:m,queuedTime:p,startTime:N,onSuccess:R,onError:T,onComplete:O});const W=gr(e,v,p,N,{onSuccess:R,onError:T,onComplete:O},s);m&&W.then(m.resolve,m.reject),l(),S&&S({queuedAt:p,startedAt:N})}else e.state=ve.Idle({}),l();return u;function l(){!u.success&&h&&h(u.stats),u.success&&c&&c(u.stats),a&&a({success:u.success,...u.stats})}})}function Xo(e,t){return new Promise((r,n)=>{e.on("message",i),e.on("error",s),e.on("exit",c),e.postMessage(t);function i(h){e.off("message",i),e.off("error",s),e.off("exit",c),r(h)}function s(h){e.off("message",i),e.off("error",s),e.off("exit",c),n(h)}function c(h){e.off("message",i),e.off("error",s),e.off("exit",c),n(new Error(`Worker exited with code ${h}`))}})}function ko(e,t){return Jt.createRequire(t.url)(e)}function Ho(e,t){return Jt.createRequire(t.url).resolve(e)}const{versions:Oe}=Sr,Er=[".cjs",".js",".mjs",".jsx",".ts",".tsx",".vue"],st=Oe[Oe.length-1].version;function pe(e){return`Usage: ${vr()} migrate [options] [<file>...]

Upgrade project source files to ensure compatibility with a specific AG Grid version

Options:
  Optional arguments:
    --to=<version>            AG Grid semver version to migrate to (defaults to ${ae(st,e)})
    --from=<version>          AG Grid semver version to migrate from
    --allow-untracked, -u     Allow operating on files outside a git repository
    --allow-dirty, -d         Allow operating on repositories with uncommitted changes in the working tree
    --apply-dangerous-edits   Automatically apply fixes that potentially change application behavior
    --num-threads             Number of worker threads to spawn (defaults to the number of system cores)
    --dry-run                 Show a diff output of the changes that would be made

  Additional arguments:
    [<file>...]               List of input files to operate on (defaults to all source files in the current working directory)

  Other options:
    --verbose, -v             Show additional log output
    --help, -h                Show usage instructions
`}function Yo(e,t){const r={from:"",to:st,allowUntracked:!1,allowDirty:!1,applyDangerousEdits:!1,numThreads:void 0,dryRun:!1,verbose:!1,help:!1,input:[]};let n;for(;n=e.shift();){if(n.includes("=")){const[i]=n.split("=",1);e.unshift(n.slice(i.length+1)),n=i}switch(n){case"--from":{const i=e.shift();if(!i||i.startsWith("-"))throw new J(`Missing value for ${n}`,pe(t));if(!zt.valid(i))throw new J(`Invalid ${n} migration starting version`,"Must be a valid semver version");r.from=i;break}case"--to":{const i=e.shift();if(!i||i.startsWith("-"))throw new J(`Missing value for ${n}`,pe(t));if(!Oe.some(({version:s})=>s===i))throw new J(`Invalid ${n} migration target version`,`Supported versions:

${Oe.map(({version:s})=>s).map(s=>` - ${ae(s,t)}${s===st?" (default)":""}`).join(`
`)}
`);r.to=i;break}case"--allow-untracked":case"-u":r.allowUntracked=!0;break;case"--allow-dirty":case"-d":r.allowDirty=!0;break;case"--allow-dangerous-edits":r.applyDangerousEdits=!0;break;case"--num-threads":{const i=e.shift();if(!i||i.startsWith("-"))throw new J(`Missing value for ${n}`,pe(t));const s=Number(i);if(isNaN(s)||s<0)throw new J(`Invalid value for ${n}: ${i}`,pe(t));r.numThreads=s;break}case"--dry-run":r.dryRun=!0;break;case"--verbose":r.verbose=!0;break;case"--help":case"-h":r.help=!0;break;default:if(n.startsWith("-"))throw new J(`Unexpected argument: ${n}`,pe(t));r.input.push(n);break}}if(r.help)return r;if(r.from&&zt.gte(r.from,r.to))throw new J(`Invalid --from migration starting version: ${ae(r.from,t)}`,`Migration starting version must be less than target version (${ae(r.to,t)})`);return r}async function zo(e,t){const{env:r,stdio:n}=t,{stdout:i}=n;if(e.help)return Bo(i,r);await Qo(e,t)}function Bo(e,t){return M(e,pe(t))}async function Qo(e,t){const{from:r,to:n,allowUntracked:i,allowDirty:s,applyDangerousEdits:c,numThreads:h,dryRun:a,verbose:u,input:o}=e,{cwd:l,env:v,stdio:p}=t,{stdout:m,stderr:S}=p,R=await go(l);if(!i&&!R)throw new ee("No git repository found","To run this command outside a git repository, use the --allow-untracked option");const T=R?(await Ko(R)).map(f=>P.resolve(R,f)):null,O=o.length>0?o.map(f=>P.resolve(l,f)):(await Jo(l)).map(f=>P.resolve(l,f));if(!i){const f=T?new Set(T):null,d=f?O.filter($=>!f.has($)):O;if(d.length>0)throw new ee("Untracked input files",["The following files are not tracked within the current git repository:",d.map($=>` ${P.relative(l,$)}`).join(`
`),"To operate on untracked files, use the --allow-untracked option"].join(`

`))}if(R&&!s){const f=new Set(O),d=(await $o(R)).map($=>P.resolve(R,$)).filter($=>f.has($));if(d.length>0)throw new ee("Uncommitted changes",["The following files within the current git repository have uncommitted changes:",d.map($=>` ${P.relative(l,$)}`).join(`
`),"To operate on repositories containing uncommitted changes, use the --allow-dirty option"].join(`

`))}const N=Oe.find(({version:f})=>f===n);if(!N)throw new ee(`Unknown version: ${ae(n,v)}`);await M(S,`Migrating${r?` from version ${ae(r,v)}`:""} to version ${ae(n,v)}...`);const _=Date.now(),H=await(h===0?(()=>{const f=ko(P.join("@ag-grid-community/codemods",N.codemodPath),{url:typeof document>"u"?require("url").pathToFileURL(__filename).href:Ne&&Ne.src||new URL("index.cjs",document.baseURI).href}),d=Fr(f),$={fs:Qr()};return u&&M(S,"Running in single-threaded mode"),Promise.all(O.map(y=>{const E=Date.now();return M(S,`Processing ${P.relative(l,y)}`),d.run({inputFilePath:y,dryRun:a,applyDangerousEdits:c},$).then(({result:g,errors:w,warnings:C})=>({path:y,result:g,errors:w,warnings:C})).catch(g=>({path:y,result:{source:null,updated:null},errors:[g],warnings:new Array})).then(g=>{if(u){const w=Date.now()-E;M(S,`Processed ${P.relative(l,y)} in ${w}ms`)}return g})}))})():(()=>{const f=Ho(P.join("@ag-grid-community/codemods",N.workerPath),{url:typeof document>"u"?require("url").pathToFileURL(__filename).href:Ne&&Ne.src||new URL("index.cjs",document.baseURI).href}),d=h||Ar.cpus().length,$=Array.from({length:d},()=>new Lr.Worker(f)),y=new Mo($);return u&&M(S,`Running in multi-threaded mode with ${d} workers`),Promise.all(O.map(E=>y.run({inputFilePath:E,dryRun:a,applyDangerousEdits:c},{onQueue:u?()=>{M(S,`Queueing ${P.relative(l,E)}`)}:void 0,onStart:()=>{M(S,`Processing ${P.relative(l,E)}`)},onComplete:u?({runningTime:g})=>{M(S,`Processed ${P.relative(l,E)} in ${g}ms`)}:void 0}).then(g=>{if(g.success)return g.value;throw g.error}).then(({result:g,errors:w,warnings:C})=>({path:E,result:g,errors:w,warnings:C})).catch(g=>({path:E,result:{source:null,updated:null},errors:[g],warnings:new Array})))).then(E=>(y.terminate(),E))})()),te=Date.now()-_,X=H.map(f=>f.errors.length===0&&f.warnings.length===0?f:null).filter(de),I=H.map(f=>f.warnings.length>0?f:null).filter(de),L=H.map(f=>f.errors.length>0?f:null).filter(de),A=X.filter(f=>f.result.updated),F=X.filter(f=>!f.result.updated);if(a){const f=X.map(d=>{const{path:$,result:{source:y,updated:E}}=d;if(!y||!E)return null;const g=P.relative(l,$),w={path:`a/${g}`,source:y},C={path:`b/${g}`,source:E};return ea(w,C)}).filter(de);if(f.length>0){const d=f.join(`

`);await M(m,d)}}if(await M(S,`Migration completed in ${te}ms (${[`${A.length} modified`,`${F.length} unmodified`,`${I.length} warnings`,`${L.length} failed`,`${H.length} total`].join(", ")})`),I.length>0)throw await M(S,""),new ee(`Encountered warnings in ${I.length} ${I.length===1?"file":"files"}`,Bt(I.map(({path:f,warnings:d})=>({path:P.relative(l,f),errors:d}))));if(L.length>0)throw await M(S,""),new ee(`Failed to process ${L.length} ${L.length===1?"file":"files"}`,Bt(L.map(({path:f,errors:d})=>({path:P.relative(l,f),errors:d}))));return X.map(({path:f})=>f)}function Bt(e){return e.map(({path:t,errors:r})=>`${t}:

${r.map(n=>lo(n.message,{indent:"  "})).join(`

`)}
`).join(`
`)}function Jo(e){return pr(e,(t,r)=>r.isDirectory()&&P.basename(t)!=="node_modules"||r.isFile()&&Zo(t))}function Ko(e){return Eo(Er.map(t=>`*${t}`),{gitRepository:e})}function Zo(e){return Er.includes(P.extname(e))}function ea(e,t){return ln(e.path,t.path,e.source,t.source,void 0,void 0,{context:3})}const ta=Cr.create({Migrate:!0});function $r(e){return`
Usage: ${vr()} [command] [options]

AG Grid developer toolkit

Commands:
  migrate         Migrate project source files for an upgraded AG Grid version

Options:
  --version, -v   Print the version of the command-line tool
  --help, -h      Show usage instructions for the specified command

See individual command help for more options
`}async function ra(e,t){const{env:r,stdio:n}=t,{stdout:i}=n,s=na(e,r);if(s&&s.help){await Qt(i);return}if(s&&s.version){await ia(i);return}if(!s||!s.command)throw await Qt(i),null;await Kt(s.command,{Migrate:({args:h})=>zo(h,t)})}function na(e,t){const r={command:null,version:!1,help:!1};for(;e.length>0;){const n=e.shift();switch(n){case"--version":case"-v":r.version=!0;break;case"--help":case"-h":r.help=!0;break;case"migrate":{r.command=ta.Migrate({args:Yo(e,t)});break}default:throw new J(`Unexpected argument: ${n}`,$r())}}return r}function Qt(e,t){return M(e,$r())}function ia(e){return M(e,require("./package.json").version)}ra(process.argv.slice(2),{cwd:process.cwd(),env:process.env,stdio:{stdin:process.stdin,stdout:process.stdout,stderr:process.stderr}}).catch(e=>{if(e)if(e instanceof ee)process.stderr.write(`${e.toString(process.env)}
`,()=>{process.exit(1)});else{if(e instanceof Error)throw e;process.stderr.write(`${String(e)}
`,()=>{process.exit(1)})}else process.exit(1)});
